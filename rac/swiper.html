<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8" />
  <title>Driver.js</title>
  <meta name="viewport" content="width=375, user-scalable=no">
  <!-- デモアプリCSS/JS -->
  <link rel="stylesheet" href="../assets/css/demo-app.css">
  <link rel="stylesheet" href="../assets/css/demo-app-elements-position.css">
  <link rel="stylesheet" href="../assets/css/drower-menu.css">
  <script src="../assets/js/demo-app.js" defer></script>
  <!-- Driver.js -->
  <link rel="stylesheet" href="../assets/css/driver-custom.css">
  <script src="https://cdn.jsdelivr.net/npm/driver.js@latest/dist/driver.js.iife.js" defer></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/driver.js@latest/dist/driver.css" />
  <!-- Swiper CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
  <!-- Swiper Custom CSS -->
  <link rel="stylesheet" href="../assets/css/swiper-custom.css">
</head>

<body>
  <div class="demo-app-wrap">
    <main class="demo-app-wrap--main">
      <!-- Drower Menu -->
      <div class="menu">
        <div class="hamburger-icon">&#x205D;</div>
        <div class="drawer-container">
          <div class="drawer">
            <div class="close-icon">✕</div>
            <ul>
              <li>ホーム</li>
              <li>エアコンの登録</li>
              <li>環境センサーの登録</li>
              <li>スマートスイッチの登録</li>
              <li>よくある質問</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Swiper -->
      <div class="swiper mySwiper">
        <div class="swiper-wrapper">
          <div class="swiper-slide">
            <div class="swiper-slide_img_holder">
              <img src="../assets/img/01.png" alt="STEP-01" />
              <div id="targetArea01"></div>
            </div>
          </div>
          <div class="swiper-slide">
            <div class="swiper-slide_img_holder">
              <img src="../assets/img/02.png" alt="STEP-02" />
              <div id="targetArea02"></div>
            </div>
          </div>
          <div class="swiper-slide">
            <div class="swiper-slide_img_holder">
              <img src="../assets/img/03.png" alt="STEP-03" />
              <div id="targetArea03"></div>
            </div>
          </div>
          <div class="swiper-slide">
            <div class="swiper-slide_img_holder">
              <img src="../assets/img/04.png" alt="STEP-04" />
              <div id="targetArea04"></div>
            </div>
          </div>
          <div class="swiper-slide">
            <div class="swiper-slide_img_holder">
              <img src="../assets/img/05.png" alt="STEP-05" />
              <div id="targetArea05"></div>
            </div>
          </div>
        </div>
        <!-- buttons -->
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
        <!-- pagination -->
        <div class="swiper-pagination"></div>
      </div>
    </main>
  </div>

  <script>
    function openNav() {
      document.getElementById("mySidenav").style.width = "250px";
    }

    function closeNav() {
      document.getElementById("mySidenav").style.width = "0";
    }
  </script>

  <!-- <script>
    const hamburgerIcon = document.querySelector('.hamburger-icon');
    const drawer = document.querySelector('.drawer');
    const closeIcon = document.querySelector('.close-icon');

    hamburgerIcon.addEventListener('click', () => {
      drawer.classList.toggle('open');
    });

    closeIcon.addEventListener('click', () => {
      drawer.classList.remove('open');
    });
  </script> -->

  <!-- Swiper JS -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <!-- Driver.js-->
  <script src="https://cdn.jsdelivr.net/npm/driver.js@latest/dist/driver.js.iife.js"></script>

  <!-- Initialize Swiper -->
<script>
  // Driver.js
  const driver = window.driver.js.driver;
  const driverObj = driver({
    overlayOpacity: 0.2,
    allowClose: true,
    disableActiveInteraction: false,
    stagePadding: 0,
    popoverClass: 'driverjs-theme',
    // smoothScroll: false  // (使っていれば競合回避に有効)
  });

  // メタデータ
  const slides = [
    { element: "#targetArea01", title: "スライド1", description: "これはスライド1の説明です。" },
    { element: "#targetArea02", title: "スライド2", description: "これはスライド2の説明です。" },
    { element: "#targetArea03", title: "スライド3", description: "これはスライド3の説明です。" },
    { element: "#targetArea04", title: "スライド4", description: "これはスライド4の説明です。" },
    { element: "#targetArea05", title: "スライド5", description: "これはスライド5の説明です。" },
  ];

  // Initialize Swiper
  const swiper = new Swiper('.swiper', {
    pagination: {
      el: '.swiper-pagination',
      type: "fraction",
    },
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
  });

  // ポップオーバー表示関数
  function highlightSlide(index) {
    const slide = slides[index];
    if (!slide) return;

    driverObj.highlight({
      element: slide.element,
      popover: {
        title: slide.title,
        description: slide.description,
      },
    });

    // overlayOpacity を 0 にしているので driver-active クラスが残ると邪魔になる場合は解除
    // document.body.classList.remove('driver-active');
  }

  // 初期表示
  window.addEventListener('DOMContentLoaded', () => highlightSlide(0));

  // スライド遷移完了後にハイライト
  swiper.on('slideChangeTransitionEnd', () => {
    highlightSlide(swiper.activeIndex);
    document.body.classList.remove('driver-active'); // driver-active クラスを削除
    document.getElementsByClassName('driver-overlay').style.display = 'none'; // driver-active クラスを削除
  });
</script>
</body>

</html>